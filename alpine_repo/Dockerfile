FROM python:3.8-alpine

ENV PYTHONUNBUFFERED 1
ENV PYTHONIOENCODING UTF-8

ADD requirements.txt .

RUN apk update
RUN apk add abuild

RUN pip install -r requirements.txt

ENV ALPINE_REPO_DEFAULT_ARCH x86_64
ENV ALPINE_REPO_DRIVER ''
ENV ALPINE_REPO_DRIVER_OPTIONS ''
ENV ALPINE_REPO_MAX_CONTENT_LENGTH ''
ENV ALPINE_REPO_CLEAN_ON_STARTUP FALSE
ENV ALPINE_REPO_INDEXER_PORT 80
ENV LOG_LEVEL INFO

EXPOSE 80

ADD ./ alpine_repo/

CMD python -m alpine_repo.entrypoint